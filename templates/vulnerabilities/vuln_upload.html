{% extends "../base.html" %}
{% block title %}Cargar Vulnerabilidades | vulnTracker{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">📤 Carga de vulnerabilidades por archivo</h2>

  <form method="post" enctype="multipart/form-data" class="border p-4 rounded bg-light">
    {% csrf_token %}
    
    <div class="mb-3">
      <label for="yaml_file" class="form-label fw-bold">Archivo YAML (formato compatible)</label>
      <input type="file" name="yaml_file" id="yaml_file" accept=".yaml,.yml" class="form-control" required>
      <small class="text-muted">Ejemplo: archivo con claves <code>title</code>, <code>description</code>, <code>impact</code>, etc.</small>
    </div>

    <div class="text-end mt-3">
      <button type="submit" class="btn btn-success">
        📥 Importar vulnerabilidades
      </button>
      <a href="{% url 'vulnerability_list' %}" class="btn btn-secondary ms-2">
        ↩️ Volver
      </a>
    </div>
  </form>

  {% if messages %}
    <div class="mt-4">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
</div>
{% endblock %}
